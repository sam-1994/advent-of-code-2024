<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Traveling Visualization</title>
  <style>
    table {
      border-collapse: collapse;
      margin: 20px auto;
    }

    td {
      width: 10px;
      height: 10px;
      text-align: center;
      vertical-align: middle;
      border: 1px solid #ccc;
      font-size: 20px;
      font-family: monospace;
      position: relative;
    }

    .blocked {
      background-color: black;
    }

    .visited {
      background-color: lightblue;
    }

    .guard {
      color: red;
      font-size: 12px;
      position: absolute;
      margin-top: -8px;
      margin-left: -4px;
    }

    .controls {
      text-align: center;
      margin: 20px;
    }

    .slider {
      width: 200px;
    }
  </style>
</head>
<body>
<h1 style="text-align: center;">Traveling Visualization</h1>
<div id="map-container" style="display: flex; justify-content: center;"></div>
<div class="controls">
  <label for="speed">Speed: </label>
  <input id="speed" type="range" min="25" max="2000" value="25" step="25" class="slider">
  <span id="speed-value">25ms</span>
  <button id="play-pause" class="button">Pause</button>
</div>

<script>
  const Direction = {
    Up: 0,
    Down: 1,
    Left: 2,
    Right: 3
  };

  const input = `
.........................#...........#.#...#...............#..............##.....................#...........#..#.........#.......
.....................#.................#.......#.........................#...........#.#.......#..................................
.........#...........#........#.........#.........#...........#........................................#.........................#
.......#.........................#...........................#.............#......................................................
..................#................##...............#.#.....................##............#.......................................
......#...#................#..................................................................#....#.#............................
.......##................#........#..#.......#......................................#........#............#......###..........#...
.....................#....................................................#...........#..#...#..........................#.........
...........#....#...........................#.#...............#..#....................................#..............#......#.....
.....#........##...............#.......#..#..............................................#..........................#.............
.#.........#.#...........................#..........................#......................#...........#........#.................
.................................................................#..#.#.......#..#................................................
...............................................#.......#...................#....................#.................................
.......#......#......#......................#...............................#.....##........#...........#......#..................
........................................................................................................#.....#.#.................
..#...............................#.#..................................#.............#............................................
..............#..........................................#.....#.....#..........................#....#.........#..................
...................................#........................................#................#...........##.....#....#............
.#.....................................#.......#........................#...................##............#.......................
.#..................#...........#...........................................................................................#.....
........................#...................................................##.................................#..#..........##...
........#............................#.......#...........................#.#...#...................................#.....#........
...............................#............#.....#......................#.......#...#........................#...................
.........#.............#.................................................#.......................................#....#...........
...................................................................#...#.................................#...................#....
...#.....................#...#...............#..................................................#...#...#.........................
...................#........#....#....#..#..#...................#.........#..................#..#....#.......#.#.................#
..............................#........................................#......#.....#..............##................#............
............#..#.............#.......#........................................................##........#.....#...................
.....#.............................................................#...#.#.#.............................#..#.#...........#.......
.......#....#............................................#.................................#...................................#..
..#.................#.......#..........................#........................................#...............#..............#..
....#.#...................#............................#..#.......................................................................
.......................#...............#..............#......#......................#.....................#..............#........
.#..........#.......................................................................#....................................#........
.#.......#..................................................................#.....................................................
..................................................#.............#.............................................#................#.#
.......................#......#....#................#......................................................#.......#.........#....
..........................#.#........................................................#......#................................#....
....................................................................#...............................#.............................
..#...........#..............................#..#....#............................#...............##..............#...#...#...#..#
...................................#................................................................#....#...................#....
..#....#........#..##....#........................#...#...................................#.......................................
...................#................................................................................................#.............
.......#........#................#...#.......................................................................#....................
..............#....................#..........................##.........#.....................................#..................
.........................................................................#.................#........................#.............
.............................#..........#.......................................................#......................#..........
............###....................................................................#.......................#......................
........#........#...........#.............................#....................#..........#.........................#.#.....#....
.........................................................................................................#..#.....................
#.#.....#..........................................................#.....................#........................................
........##..........#....................................................#..#........#.......#........#................#..........
.............................................#..........................#.........#........................#......................
...........................##.............#........................#.#........................#..#................#.....#........#
#...#..............................................#........#...................................................#.................
.............#................#............................#............#.........................................................
#..........................#............#.....................#.....#.................#......#...##...#.............#.#...........
.....................#...#..#....#...................................#....................#..............#........#...............
.......................#.................#...........#....#.......#...........................................#..#................
.........#...........#.#.........#.........................#.....#................................................................
....................#........#...................................................................#............#..#.#.#............
..........#.......................#.......................#.......................................................................
......................................#......#............................#..............................................#........
.....................#...#.................#.............................#....#...................................................
..............##...................................................................#......................................##......
.....#....#...............................................#.......#.##........#.#.............#...............#...................
....................................#......................#........#.......................................................#.....
.....#.........................................#.....................#.............#.................#..................#.........
................................#.........#..#............................................#.........................#.............
....#.#.....................#......#...................................#..........................................#..#.....#...#..
.........##.......................#..........................................#.........................#...##.....................
...............................................................#................................................................#.
............#.........................................##.......................................#..................................
.............................#..............................#..................#.........#.....#..................................
..........................................................#...#.....#..................#................................#.........
......#...................#.........................................................................................#.............
#...............................#...........................#.....................................................................
.......#........#.................................................#.......................................................#.......
.#......................................................#..............#..................................#...........#...........
.............#..#.#.......................#..........#......#.##.........................................................#..#.....
.......#...............#........#......................................................................#..#...........#...........
............#.........................................#................................................#...................#......
............#...........................................#.#.......#....................................#..........................
...........................................#.........................................................#..............#.............
..................#..#....................................................#..................#....................................
..#........................#........#.............................................................................................
.............#........#......................#.......................................#...#....#............................#......
............#.......#.............#...#...........#.#.................................#.................##........................
.....................................................................................#.........#.......................#.....#....
.................#................................#..#....#......#..........................................#.....#...............
..#...............................#........................................................#.......#...#............#.............
#.........#..#..#.....................................#....................................#................#.................#...
.......................#..#...#............................................................................#..#.....#.......##....
..........#............#.......................#.........................^......#.#...................................#...........
...##........................##..........#..........#.................#...............#...........#.....##........................
..............#............#..........................#....#...........#......#......#......................#.....................
......#.....#....................................................#............#.#......................................#..........
......#.............................#......................#...............................#........#.............................
.#..........#.............................................#.............................................#.........................
...............................##.................................................................................................
.....................#................................................#...............#............#...............#.....#.....#..
..................#...........................................................................#...........#...................#...
##..............................#.#...#.#...............................#...........#.#...................#.......................
......................#.........#...................................#.................#...........................................
.......................#............................................................................#.........##...........#......
.....................................................................#.......#.....#.......................................#......
#....................................#........#.#.................................................................##.....#........
..............#..............................#......#..........###.........#................#..............#..................#...
..................................#..............................#.................##.............................#...#...........
...............#......#........................#....#........#............#.........#..........#..............#......#............
...#...........#........#...#...........................#.............#.....................................#.....................
..............###............#...........................................................#.............#.........##..#............
............#................................................#.......#..................#....#....................................
.........#.#...#.....#...........................#.....##......#.....................#..#........#......#.........................
.#....#.......#.......................#.................................................................#.......#..............#..
...................#................................................................#.............#...#...........#.........#.....
.......#.#.......#.......................#....#.....#...............#...#.....#...........................................#.......
.......#........#...........................................#...........#.........................#....#.......#..................
..................................#.#.................#.#............................................#...........#....#...........
....##......#.............#...................................#...#.........#...........................#......#..................
.........................#......#....#...#........................................................................................
...#...............#............................................................................#...........................#.....
....##.#..............................................#............#................#................................#......#.....
.........#...........................................#...#.......##..............................#................................
..................#..........#......#.......#......................................#........#...............#......#...........##.
........................................#......#..........#......................................................................#
..............#...#...................#.....#..........................................................#..............#......#....
...#........#........................#...#................#........#.............................##..........................#....
............#............................#.#........................#.................................#..........................#
    `;

  let guard;
  let interval;
  let speed = 25;
  let isPaused = false;

  const map = input.trim().split('\n').map((line, y) =>
    line.split('').map((char, x) => {
      if ('^v<>'.includes(char)) {
        guard = {
          x,
          y,
          direction: { '^': Direction.Up, 'v': Direction.Down, '<': Direction.Left, '>': Direction.Right }[char],
          finished: false
        };
        return { blocked: false, visited: true };
      }
      return { blocked: char === '#', visited: false };
    })
  );

  function renderMap() {
    const container = document.getElementById('map-container');
    container.innerHTML = '';
    const table = document.createElement('table');

    map.forEach((row, y) => {
      const tr = document.createElement('tr');
      row.forEach((field, x) => {
        const td = document.createElement('td');
        if (x === guard.x && y === guard.y) {
          const guardSpan = document.createElement('span');
          guardSpan.textContent = {
            [Direction.Up]: '^',
            [Direction.Right]: '>',
            [Direction.Down]: 'v',
            [Direction.Left]: '<'
          }[guard.direction];
          guardSpan.classList.add('guard');
          td.appendChild(guardSpan);
        }
        if (field.blocked) {
          td.classList.add('blocked');
        } else if (field.visited) {
          td.classList.add('visited');
        }
        tr.appendChild(td);
      });
      table.appendChild(tr);
    });

    container.appendChild(table);
  }

  function moveGuard() {
    map[guard.y][guard.x].visited = true;
    if (guard.finished) return;
    switch (guard.direction) {
      case Direction.Up:
        if (guard.y === 0) {
          guard.finished = true;
        } else if (map[guard.y - 1][guard.x].blocked) {
          guard.direction = Direction.Right;
        } else {
          guard.y--;
        }
        break;
      case Direction.Right:
        if (guard.x === map[guard.y].length - 1) {
          guard.finished = true;
        } else if (map[guard.y][guard.x + 1].blocked) {
          guard.direction = Direction.Down;
        } else {
          guard.x++;
        }
        break;
      case Direction.Down:
        if (guard.y === map.length - 1) {
          guard.finished = true;
        } else if (map[guard.y + 1][guard.x].blocked) {
          guard.direction = Direction.Left;
        } else {
          guard.y++;
        }
        break;
      case Direction.Left:
        if (guard.x === 0) {
          guard.finished = true;
        } else if (map[guard.y][guard.x - 1].blocked) {
          guard.direction = Direction.Up;
        } else {
          guard.x--;
        }
        break;
    }
  }

  function startSimulation() {
    clearInterval(interval);
    renderMap();
    interval = setInterval(() => {
      moveGuard();
      renderMap();
      if (guard.finished) {
        clearInterval(interval);
        alert('Guard has finished traveling!');
      }
    }, speed);
  }

  function togglePausePlay() {
    const playPauseButton = document.getElementById("play-pause");
    isPaused = !isPaused;
    if (isPaused) {
      playPauseButton.textContent = "Play";
      clearInterval(interval); // Stop the simulation
    } else {
      playPauseButton.textContent = "Pause";
      startSimulation(); // Restart the simulation
    }
  }


  // Event listener for speed control
  const speedSlider = document.getElementById('speed');
  const speedValue = document.getElementById('speed-value');
  const playPauseButton = document.getElementById("play-pause");

  speedSlider.addEventListener('input', (e) => {
    speed = parseInt(e.target.value);
    speedValue.textContent = `${speed}ms`;
    startSimulation(); // Restart simulation with updated speed
  });

  playPauseButton.addEventListener("click", togglePausePlay);


  startSimulation();
</script>
</body>
</html>
